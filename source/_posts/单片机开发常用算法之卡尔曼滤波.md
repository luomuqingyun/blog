---
title: 单片机开发常用算法之卡尔曼滤波
date: 2025-05-19 14:42:00
author: luomuqingyun
comments: true
category:
  - 编程
tags:
  - 编程经验
excerpt:
  - 详见完整内容
---
占位
>本文因没有制作相关图片后面算法内容似乎不能用纯文字描述出让人一看就懂的意思，精彩图文见优质的`参考资料`链接（公众号不支持跳转外链，所以网页链接转注脚了），图文说明确实比文字表达得更精彩，先借用别人链接参考参考。以后的文章再做动图演示。
## 算法——产品的软核
我们生活中的电子产品随处可见，有简单的，也有复杂的，其中大多数产品都需要用到微控制器进行控制。对于简单的电器可能只需要简单的控制几个微控制器I/O口通断，或再配合着定时器、中断等功能，最后通过搭配其他一些外部器件就可以实现产品功能了。但是对于一些涉及到某些复杂控制，或需要复杂计算才能实现控制功能的产品，以上对微控制的简单操作就不能实现需要的产品功能，这样的产品就需要我们在程序中编写一些控制算法才能实现。往往生活中的很多电器产品都不是几行代码就能实现得了的，所以我们用单片机进行项目开发时通常离不开算法。

在项目开发过程中涉及到的算法非常多，并且产品功能越复杂对算法的要求会越高，并且即使是同样的产品对它的要求越高需要的算法肯定也就更复杂，甚至如果算法设计得合理，有时还可以节约硬件成本。对于开发者来说，即便以后的不从事算法工程相关的工作也需要掌握一些算法知识。算法的本质就是对数据进行某些特定的处理或运算，从而获得我们需要的结果，进而控制微控制器做出相应的动作，最终实现产品功能。简单一点的算法应该就是我们最常见的一些基本运算吧，复杂一点的可能是排序、查找、滤波等算法，再复杂一点就需要处理开根号，微分，积分，矩阵，傅里叶变换等等一系列相对复杂的高等运算了。当然控制器不是人脑，只能进行二进制处理，肯定不能像人脑一样能够识别各种运算符号。但通过我们程序处理、优化再结合其内部运算单元就可以完成复杂运算了，当然其内部结构与运算单元往往也决定其能以怎么样是速度完成这些运算。当然，如果要实现一些复杂算法那肯定还是需要使用更高性能的控制器，比如，DSP芯片就是专门为数字信号处理而设计的芯片，不过现在一些性能比较高的微控制器内核也会附带一个简单的DSP单元。因为软件算法种类非常的多，几乎每一种成熟的算法都足以写一本书出来了，所以后续会在这里写一系列我熟悉的软件算法相关的文章，与大家一起交流学习。这篇文章我们先来介绍一种单片机开发时使用比较多的算法——卡尔曼滤波算法。

## 何为数字滤波器
谈到滤波算法就不得不涉及数字滤波器，学习模拟电路的时候我们肯定都接触了滤波器，这也是模拟电路中很重要的一部分。通常情况下模拟滤波器都是由电路中的电阻、电容或电感以及相应的运放构成，在电路中起到对某些特定频率的信号进行抑制的作用。那数字滤波器呢？顾名思义它就是对数字信号进行处理从而达到预期频率响应的信号系统。既然有模拟滤波器了为何还需要数字滤波器呢？由于模拟滤波器是由各类模拟电子元器件构成，在实际工作状态下每种元器件的参数及性能都可能受电流，温度，电磁等环境影响，在某些情况下可能对产品的功能影响比较大，而傅里叶变化可以巧妙的将时域信号转化为频域信号，对模拟信号采样后再经过一定的处理可以把这些复杂的信号变得相对容易处理，这也就是数字滤波器最大的优势了，最大程度上克服了信号的环境影响，而具有很高的稳定性。因为傅里叶变换的运算比较复杂，即使是优化后的快速傅里叶变换对于普通单片机来说都是很消耗资源的，所以在一些要求不高的应用中也会使用卷积进行相应的运算来实现数字滤波效果，来达到设计效果。

数字滤波器是通过其幅频特性和相频特性函数推导进行设计的，所以模拟电路中一些常见的滤波器电路模型都有其对应的数字滤波器模型。经典的数字滤波器包括FIR和IIR两种，随着设计的优化出现了维纳滤波器、卡尔曼滤波器、线性预测器、自适应滤波器等现代滤波器。关于数字滤波器的仿真可以使用Matlab软件，在软件命令行窗口中输入fdatool打开滤波器设计工具箱进行相应设置。可参考官方链接：
[数字滤波器设计](https://ww2.mathworks.cn/help/signal/filter-design.html?s_tid=CRUX_lftnav "数字滤波器设计")

这些内容似乎都太深奥，很容易把人看晕。在我们学信号与系统这门课时往往不知道这门课具体可以做什么，正好现在刚好可以回顾一下。如果不想看书可以参考知乎上的一些回答，比如：[如何理解傅里叶变换公式？](https://www.zhihu.com/question/19714540/answer/1119070975 "如何理解傅里叶变换公式？")但是不是这篇文章的重点，总之很多控制算法都源自于这本书，如果是在校的单片机初学者看到这里往后应该要对信号与系统这门课更加重视一些。里面一些更细节的问题，后续在做介绍，接下来先介绍今天文章的主角。
## 卡尔曼滤波器
卡尔曼滤波器是现代滤波器的一种，它是一种高效率的递归滤波器（自回归滤波器），它能够从一系列的不完全及包含噪声的测量中，估计动态系统的状态，确切的说它更是一种预测算法。所以在惯性导航，智能控制方面应用非常广泛。对于航空航天等高科技应用场景我们普通开发者参与的机会肯定是比较小的，但我们可以利用它进行设计无人机，智能小车，小机器人是完全可以实现的。这也是写这篇文章的原因，因为现在针对大学生的多数设计竞赛都会有相关的赛题，所以学习这种算法还是很有必要的。

由于其原理详细介绍起来不比傅里叶变换简单，估计多数人都会望而却步，所以有条件的朋友可以参考这篇外文论文：[How a Kalman filter works, in pictures](https://www.bzarg.com/p/how-a-kalman-filter-works-in-pictures/ "How a Kalman filter works, in pictures")。本想转述一遍大概意思，结果发现知乎上也有翻译版了：[图说卡尔曼滤波，一份通俗易懂的教程](https://zhuanlan.zhihu.com/p/39912633 "图说卡尔曼滤波，一份通俗易懂的教程")。这样的介绍绝对比用纯文字介绍更形象生动，如果觉得翻译的差点意思可以移步到这篇文章：[卡尔曼滤波器预测原理](https://www.cnblogs.com/louisanu/p/12803272.html "卡尔曼滤波器预测原理")



