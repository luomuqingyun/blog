---
title: PID算法（一）之简介
date: 2025-05-19 14:42:00
author: luomuqingyun
comments: true
# mathjax: true
math: true
mermaid: true
sidebar: [toc, tags, category] 
category:
  - 编程
  - 算法
tags:
  - 编程经验
  - 算法应用
excerpt:
  - PID算法
---
### PID算法原理
PID(比例-积分-微分)算法是一种广泛应用于工业过程控制的线性控制算法，大多数与控制相关的电器设备都有它的身影。它根据系统的测量值和目标值的误差,产生控制输出来驱动被控系统朝目标状态移动。

PID算法包含了三个部分:比例项P、积分项I、微分项D，具体应用时通过调节各部分参数来实现对控制系统的稳定控制。

- 比例项P:比例项依据当前时刻的误差值产生控制量,系数为比例增益Kp。其数学表达式为:$Pout = Kp*e(t)$。增加比例增益Kp可以加快系统的响应速度,但是太大会导致系统震荡，太小可能系统很难达到预期值。

- 积分项I:积分项依据过去的误差进行积分,其控制量与积分时间及误差的积分值成正比,系数为积分增益Ki。其数学表达式为:$Iout = Ki*∫e(t)dt$。增加积分增益Ki可以减小系统稳态误差,但是太大也会引起震荡，但太小也可能影响系统预期设计。

- 微分项D:微分项依据误差的变化率进行微分,其控制量与误差变化率成正比,系数为微分增益Kd。其数学表达式为:$Dout = Kd*de(t)/dt$。增加微分增益Kd可以提高系统的稳定性和抗干扰能力,但是太大同样会引起震荡。

PID控制器的综合控制函数为:

$$
u(t) = Kp*e(t) + Ki*∫e(t)dt + Kd*de(t)/dt
$$

通过调节Kp、Ki、Kd这三个参数可以获得想要的系统控制性能。

![PID算法框架](https://files.mdnice.com/user/38598/c13fcb0f-fd82-4432-b096-57127879cbce.png)

我们可以根据比较理想的仿真动图看看各参数对系统的影响效果。

占位插图

## PID算法程序实现
利用时间离散可以将PID控制器实现在数字系统中，从而以程序的形式实现。具体算法流程如下:

1) 读取传感器测量当前值$pv(k)$

2) 计算误差 $e(k)=sp(k)-pv(k) $

3) 比例项 $Pout = Kp*e(k) $ 

4) 积分项 $Iout+=Ki*e(k)*Δt  $

5) 微分项 $Dout=Kd*(e(k)-e(k-1))/Δt$

6) 计算总控制量 $u(k)=Pout+Iout+Dout$

7) 输出控制量$u(k)$到执行机构

下面是一个使用C语言实现的简单PID控制器代码示例:

```c
float pid_control(float sp, float pv) {

  float ek = sp - pv; // 计算当前时刻误差
  
  Pout = Kp * ek; // 比例项
  
  Iout += Ki * ek * dt; // 积分项
  
  Dout = Kd * (ek - ek_1) / dt; // 微分项
  
  ek_1 = ek; // 保存上一时刻误差

  uk = Pout + Iout + Dout; // PID控制量
  
  return uk;

}
```
通过上述代码可以实现一个基本的PID控制器逻辑，在结合其他控制程序就可以实现简单的PID控制了。


## PID算法参数调试

确定PID参数的方法有多种,常见的有经验法则调节、绝对模式法、自整定法等。

- Kp - 比例增益:决定了系统的响应速度,值越大速度越快,但是若过大会产生震荡。

- Ki - 积分增益:决定了系统抵消稳态误差的能力,值越大稳态误差越小,但是过大也会有震荡。

- Kd - 微分增益:决定了系统稳定性和抗干扰的能力,值越大效果越好,但是过大同样会震荡。

在实际应用中调参往往更需要经验，很早就有人写过关于PID调参的论文，新手可以下载这些论文做参考，当然也有很多人总结了一些比较好滴经验，比如

>参数整定找最佳，从小到大顺序查。
>
>先是比例后积分，最后再把微分加。
>
>曲线振荡很频繁，比例度盘要放大。
>
>曲线漂浮绕大弯，比例度盘往小扳。
>
>曲线偏离回复慢，积分时间往下降。
>
>曲线波动周期长，积分时间再加长。
>
>曲线振荡频率快，先把微分降下来。
>
>动差大来波动慢，微分时间应加长。
>
>理想曲线两个波，前高后低四比一。
>
>一看二调多分析，调节质量不会低。


调参的目的是使三项参数协调工作,快速达到目标值后保持稳定。如果是初次调试某个系统可以参考其他人的经验，得到一些参考值,接着可以从该参数值开始逐渐调整3个参数，直到调到满意位置。如果你调的系统没有可以参考的案例，那你就需要根据实际设计值结合你系统的相应特点先设置一个测试P值，遵守以上规则从先到大测试。

并且，在很多情形下，PID 控制并不一定需要全部的三项控制作用，而是可以方便灵活地改变控制策略，实施P、PI、PD或PID三个参数相组合的控制方式。特别是在一些时效性不强的系统或延时比较大的系统，比如加热设备，控制起来就相对比较容易。但在时效性强的系统中还是需要妥善调节控制参数的，比如电机转速。

在实际调整的过程中多测试，根据结果来进行调整，从而改善系统稳定性，当然前期也可以设计一个模拟系统响应的程序来进行仿真，较少后期调试的时间。

在仿真系统中我们就可以大概得出一个与实际相近的参数，当然你对系统的设计越完善你仿真结果与实际参数才会更接近，不然可能出现仿真与实际参数相去甚远的情况。

![我们理想的执行效果](https://files.mdnice.com/user/38598/d18edaf3-093d-4a3b-817b-73205b0299f3.png)

这样的理想型模型在实际调试中实现起来还是很难的，能调出这样的参数需要我们对系统的各个环节都非常的了解，包括各种环境参数。

![实际情况中可以调节出很好控制效果的模型](https://files.mdnice.com/user/38598/c84a164e-6b16-43b6-9395-b37850a9a1c0.png)

这个模型倒是我们在实际调试结果中比较常见的效果，能调出这种效果就是一个很不错的系统了。

![参数尚需优化的执行结果](https://files.mdnice.com/user/38598/6802bc67-1868-4b2b-bcf8-4a7e48479a6b.png)

这张图中的效果是我们实际调试过程中见得比较多的现象，当然我的仿真模型相对还是理想化了，加上横坐标密度偏大，很对细节不能详细反映出来，实际过程可能有一个比较长的振荡过程。

![参数还很差的执行结果](https://files.mdnice.com/user/38598/838dd7d5-df5f-470b-8e04-0f2394525153.png)

上面的这张图也许是很多系统刚调试时出现的状况，通过对参数的一步步调试优化逐渐得到我们想要的系统效果。

![带噪音的实际运行结果](https://files.mdnice.com/user/38598/1145c1c6-af21-4f02-9738-944362a6680c.png)

在实际过程中，肯定少不了各种噪音，所以实际参数比模拟仿真参数有差距是正常现象。如果你是刚学调参，如果对自己设计的系统不太了解，或仿真程序不是你设计的，那还是不要过于迷信仿真数据，不然你可能倍受打击。

----
>>>文章内容为作者个人观点，难免有疏忽或错误，若有不同见解可以交流评论，若发现错误还请指正，若认同文章观点，欢迎关注，分享。

>>>如学习需要或技术合作可以扫码添加微信。
建有交流群，以方便大家平时交流、学习，如果要进群，加好友时记得备注信息`进群`。
![](https://files.mdnice.com/user/38598/6fbcd253-edc6-4175-ba0c-44e24ad33b21.jpg)

占位

`温馨提示：若需要获取分享的资料，进入公众号后台发送关键字内容即可自动获取，而不是在留言或个人微信聊天界面发送！！！`

#### 推荐阅读
- [怎么快速上手一款新的MCU](https://mp.weixin.qq.com/s?__biz=MzI1OTQ4MTg4Ng==&mid=2247485581&idx=1&sn=b36e6536717774f7931c7aa93d5b237a&chksm=ea7900fcdd0e89ea0db13737720edc996fcb3fdbab3e43b4a92316240ac66d4b5a8bf9a07e78&token=466212876&lang=zh_CN#rd)
- [初学者看得懂代码却写不出怎么办](https://mp.weixin.qq.com/s?__biz=MzI1OTQ4MTg4Ng==&mid=2247485862&idx=1&sn=830ede5ac467c8d396adfbea141f0526&chksm=ea7901d7dd0e88c1e8e5396305ab83c6fbd884cf356ad64c54463230364e865a1659f193dd1f&token=63320980&lang=zh_CN#rd)
- [51单片机入门看这一篇就够了](https://mp.weixin.qq.com/s?__biz=MzI1OTQ4MTg4Ng==&mid=2247485523&idx=1&sn=b7fcd1b86e2467d6f03b1a520c39bb06&chksm=ea790022dd0e893452c4994fa16d63111b16d9878c303712f695b58b7af360b7b18c1ed4b201&token=1711068967&lang=zh_CN#rd)
- [实用单片机、电子开发小工具集](https://mp.weixin.qq.com/s?__biz=MzI1OTQ4MTg4Ng==&mid=2247485606&idx=1&sn=2b433faa2e436fc762dc538c9cf3fe14&chksm=ea7900d7dd0e89c169f8948ff3d423016c8f51f1c914eb7b0d20cba8145b9ffa54815915d67b&token=1580674001&lang=zh_CN#rd)
- [Keil软件如何高效格式化代码](https://mp.weixin.qq.com/s?__biz=MzI1OTQ4MTg4Ng==&mid=2247485572&idx=1&sn=17cefa35d9d660083d419a7e9b6db6f7&chksm=ea7900f5dd0e89e35b65ba26354cc69ad24f686d8e18abd34e0932567a9345e8c9ed653eee6b&token=1711068967&lang=zh_CN#rd)
- [两个电子开发初学者用得上的工具](https://mp.weixin.qq.com/s?__biz=MzI1OTQ4MTg4Ng==&mid=2247485987&idx=1&sn=106e52add61999ae4bddd8b28c7ed2b1&chksm=ea790252dd0e8b44e36e26f20153b1bd73a0fff98ef3c50330358435a9dfac2d97e04a30d59e&token=63320980&lang=zh_CN#rd)
- [windows平台上非常实用的小工具](https://mp.weixin.qq.com/s?__biz=MzI1OTQ4MTg4Ng==&mid=2247485420&idx=2&sn=728ca4abbadf7caf51c392e7d7045cbe&chksm=ea790f9ddd0e868b9fa162c80db1876199845f387bbe851c8d38a4e8412329ae635916c13cfb&token=1711068967&lang=zh_CN#rd)
- [51单片机入门学习推荐书单](https://mp.weixin.qq.com/s?__biz=MzI1OTQ4MTg4Ng==&mid=2247485689&idx=3&sn=d4c0d26781f307ffd26defdc4022c928&chksm=ea790088dd0e899e2872692b9568309e779acfc515e82c28a853d4228de2e2b8f7ee7149913f&token=63320980&lang=zh_CN#rd)
- [零基础电子技术知识集合](https://mp.weixin.qq.com/s?__biz=MzI1OTQ4MTg4Ng==&mid=2247485689&idx=4&sn=211c2d0871a19c5e92cdf0c34f01d96b&chksm=ea790088dd0e899e3042a649a346bc98e94189d1fd18da2b954a7ddb781582dc2d0a82e07f4d&token=970763775&lang=zh_CN#rd)
----

